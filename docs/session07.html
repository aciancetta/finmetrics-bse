<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Session 7 Volatility modeling in practice | Financial Econometrics - Tutorials</title>
  <meta name="description" content="TA materials for the Financial Econometrics course held by Prof. Christian Brownlees at the Barcelona School of Economics." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Session 7 Volatility modeling in practice | Financial Econometrics - Tutorials" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="TA materials for the Financial Econometrics course held by Prof. Christian Brownlees at the Barcelona School of Economics." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Session 7 Volatility modeling in practice | Financial Econometrics - Tutorials" />
  
  <meta name="twitter:description" content="TA materials for the Financial Econometrics course held by Prof. Christian Brownlees at the Barcelona School of Economics." />
  

<meta name="author" content="Alessandro Ciancetta" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="session06.html"/>
<link rel="next" href="session08.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Financial Econometrics at BSE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="session01.html"><a href="session01.html"><i class="fa fa-check"></i><b>1</b> Introduction to time series</a>
<ul>
<li class="chapter" data-level="1.1" data-path="session01.html"><a href="session01.html#stochastic-processes-and-dependence"><i class="fa fa-check"></i><b>1.1</b> Stochastic processes and dependence</a>
<ul>
<li class="chapter" data-level="" data-path="session01.html"><a href="session01.html#stationarity"><i class="fa fa-check"></i>Stationarity</a></li>
<li class="chapter" data-level="" data-path="session01.html"><a href="session01.html#ergodicity"><i class="fa fa-check"></i>Ergodicity</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="session01.html"><a href="session01.html#asymptotic-results"><i class="fa fa-check"></i><b>1.2</b> Asymptotic results</a></li>
<li class="chapter" data-level="1.3" data-path="session01.html"><a href="session01.html#empirical-moments-and-summary-statistics"><i class="fa fa-check"></i><b>1.3</b> Empirical moments and summary statistics</a></li>
<li class="chapter" data-level="1.4" data-path="session01.html"><a href="session01.html#hypothesis-testing"><i class="fa fa-check"></i><b>1.4</b> Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="session02.html"><a href="session02.html"><i class="fa fa-check"></i><b>2</b> Forecasting with time-series regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="session02.html"><a href="session02.html#oracle-inequality"><i class="fa fa-check"></i><b>2.1</b> Oracle inequality</a></li>
<li class="chapter" data-level="2.2" data-path="session02.html"><a href="session02.html#application-forecasting-unemployment"><i class="fa fa-check"></i><b>2.2</b> Application: forecasting unemployment</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="session03.html"><a href="session03.html"><i class="fa fa-check"></i><b>3</b> Large-dimensional methods for forecasting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="session03.html"><a href="session03.html#preprocess-fred-md"><i class="fa fa-check"></i><b>3.1</b> Preprocess FRED-MD</a></li>
<li class="chapter" data-level="3.2" data-path="session03.html"><a href="session03.html#forecasting-algorithms"><i class="fa fa-check"></i><b>3.2</b> Forecasting algorithms</a></li>
<li class="chapter" data-level="3.3" data-path="session03.html"><a href="session03.html#forecast-evaluation"><i class="fa fa-check"></i><b>3.3</b> Forecast evaluation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="session04.html"><a href="session04.html"><i class="fa fa-check"></i><b>4</b> ARMA(1,1) model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="session04.html"><a href="session04.html#mle-for-the-arma11"><i class="fa fa-check"></i><b>4.1</b> MLE for the ARMA(1,1)</a></li>
<li class="chapter" data-level="4.2" data-path="session04.html"><a href="session04.html#exercises"><i class="fa fa-check"></i><b>4.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="session05.html"><a href="session05.html"><i class="fa fa-check"></i><b>5</b> ARMA models in practice</a>
<ul>
<li class="chapter" data-level="5.1" data-path="session05.html"><a href="session05.html#forecasting-the-u.s.-gdp-growth"><i class="fa fa-check"></i><b>5.1</b> Forecasting the U.S. GDP growth</a></li>
<li class="chapter" data-level="5.2" data-path="session05.html"><a href="session05.html#exercises-1"><i class="fa fa-check"></i><b>5.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="session06.html"><a href="session06.html"><i class="fa fa-check"></i><b>6</b> Volatility modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="session06.html"><a href="session06.html#garch11-estimation"><i class="fa fa-check"></i><b>6.1</b> GARCH(1,1) estimation</a></li>
<li class="chapter" data-level="6.2" data-path="session06.html"><a href="session06.html#exercises-2"><i class="fa fa-check"></i><b>6.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="session07.html"><a href="session07.html"><i class="fa fa-check"></i><b>7</b> Volatility modeling in practice</a>
<ul>
<li class="chapter" data-level="7.1" data-path="session07.html"><a href="session07.html#the-arma11-tgarch11-model"><i class="fa fa-check"></i><b>7.1</b> The ARMA(1,1)-TGARCH(1,1) model</a></li>
<li class="chapter" data-level="7.2" data-path="session07.html"><a href="session07.html#modeling-the-sp-500-volatility"><i class="fa fa-check"></i><b>7.2</b> Modeling the S&amp;P 500 volatility</a></li>
<li class="chapter" data-level="7.3" data-path="session07.html"><a href="session07.html#exercises-3"><i class="fa fa-check"></i><b>7.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="session08.html"><a href="session08.html"><i class="fa fa-check"></i><b>8</b> Value-at-Risk and correlation modelling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="session08.html"><a href="session08.html#exercises-4"><i class="fa fa-check"></i><b>8.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="session09.html"><a href="session09.html"><i class="fa fa-check"></i><b>9</b> Additional exercises</a>
<ul>
<li class="chapter" data-level="9.1" data-path="session09.html"><a href="session09.html#exercises-5"><i class="fa fa-check"></i><b>9.1</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/aciancetta" target="blank">Alessandro Ciancetta</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Financial Econometrics - Tutorials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="session07" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Session 7</span> Volatility modeling in practice<a href="session07.html#session07" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="the-arma11-tgarch11-model" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> The ARMA(1,1)-TGARCH(1,1) model<a href="session07.html#the-arma11-tgarch11-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this session we include the conditionally-heteroskedastic models into the ARMA framework. In particular, we consider an ARMA(1,1) model with conditionally-heteroskedastic innovations and asymmetric effects. For simplicity, we just consider first-order difference equations, but the model can be generalized to include more lags. The model is an ARMA(1,1)-TGARCH(1,1) of the following form:</p>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;= c + \phi y_{t-1} + \theta \varepsilon_{t-1} + \varepsilon_t \\
\varepsilon_t &amp;= \sigma_t z_t \\
\sigma^2_t &amp;= \omega + \alpha y_{t-1}^2 + \beta \sigma^2_{t-1} + \gamma y_{t-1}^2 \mathbb{1}_{y_{t-1}&lt;0}
\end{aligned}
\]</span></p>
<p>Throughout this session, we consider <span class="math inline">\(z_t \sim \mathcal{N}(0,1)\)</span> and we estimate the model via maximum-likelihood. Let <span class="math inline">\(I_t = \{y_1, \dots, y_t, \varepsilon_1, \dots, \varepsilon_t, \sigma_1, \dots, \sigma_t\}\)</span>. The log-likelihood of the model is:</p>
<p><span class="math display">\[
\ell(\theta; I_T) = -\frac{T-1}{2} \log(2\pi) - \frac{1}{2}\sum_{t=2}^T \log \sigma_t(I_{t-1}; \theta) - \frac{1}{2}\sum_{t=2}^T \frac{( \varepsilon_t(I_{t-1}; \theta))^2}{\sigma^2_t(I_{t-1}; \theta)},
\]</span></p>
<p>where expressions for <span class="math inline">\(\sigma_t(I_{t-1}; \theta), \ \varepsilon_t(I_{t-1}; \theta)\)</span> can be found using a standard filtering procedure (Exercise 3).</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="session07.html#cb105-1" tabindex="-1"></a><span class="do">## Simulate data from ARMA(1,1)-TGARCH(1,1) process</span></span>
<span id="cb105-2"><a href="session07.html#cb105-2" tabindex="-1"></a><span class="co"># set parameters</span></span>
<span id="cb105-3"><a href="session07.html#cb105-3" tabindex="-1"></a>t_max <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb105-4"><a href="session07.html#cb105-4" tabindex="-1"></a>c     <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb105-5"><a href="session07.html#cb105-5" tabindex="-1"></a>phi   <span class="ot">&lt;-</span> <span class="fl">0.85</span></span>
<span id="cb105-6"><a href="session07.html#cb105-6" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.1</span></span>
<span id="cb105-7"><a href="session07.html#cb105-7" tabindex="-1"></a>omega <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb105-8"><a href="session07.html#cb105-8" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb105-9"><a href="session07.html#cb105-9" tabindex="-1"></a>beta  <span class="ot">&lt;-</span> <span class="fl">0.85</span></span>
<span id="cb105-10"><a href="session07.html#cb105-10" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb105-11"><a href="session07.html#cb105-11" tabindex="-1"></a></span>
<span id="cb105-12"><a href="session07.html#cb105-12" tabindex="-1"></a><span class="co"># simulate</span></span>
<span id="cb105-13"><a href="session07.html#cb105-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb105-14"><a href="session07.html#cb105-14" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(t_max)</span>
<span id="cb105-15"><a href="session07.html#cb105-15" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">rep</span>(<span class="cn">NA</span>, t_max))</span>
<span id="cb105-16"><a href="session07.html#cb105-16" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">rep</span>(<span class="cn">NA</span>, t_max))</span>
<span id="cb105-17"><a href="session07.html#cb105-17" tabindex="-1"></a>y     <span class="ot">&lt;-</span> <span class="fu">c</span>(sigma2[<span class="dv">1</span>]<span class="sc">*</span>z[<span class="dv">1</span>], <span class="fu">rep</span>(<span class="cn">NA</span>, t_max))</span>
<span id="cb105-18"><a href="session07.html#cb105-18" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(t_max<span class="sc">+</span><span class="dv">1</span>)) {</span>
<span id="cb105-19"><a href="session07.html#cb105-19" tabindex="-1"></a>  <span class="fu">set.seed</span>(t<span class="sc">*</span><span class="dv">212</span>) <span class="co"># for reproducibility</span></span>
<span id="cb105-20"><a href="session07.html#cb105-20" tabindex="-1"></a>  <span class="co"># sigma2[t]  &lt;- omega + alpha*y[t-1]^2 + beta*sigma2[t-1] + gamma*y[t-1]^2 + gamma*y[t-1]^2*(y[t-1]&lt;0)</span></span>
<span id="cb105-21"><a href="session07.html#cb105-21" tabindex="-1"></a>  sigma2[t]  <span class="ot">&lt;-</span> omega <span class="sc">+</span> alpha<span class="sc">*</span>y[t<span class="dv">-1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> beta<span class="sc">*</span>sigma2[t<span class="dv">-1</span>] <span class="sc">+</span> gamma<span class="sc">*</span>y[t<span class="dv">-1</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(y[t<span class="dv">-1</span>]<span class="sc">&lt;</span><span class="dv">0</span>)</span>
<span id="cb105-22"><a href="session07.html#cb105-22" tabindex="-1"></a>  epsilon[t] <span class="ot">&lt;-</span> sigma2[t]<span class="sc">*</span>z[t]</span>
<span id="cb105-23"><a href="session07.html#cb105-23" tabindex="-1"></a>  y[t]       <span class="ot">&lt;-</span> c <span class="sc">+</span> phi<span class="sc">*</span>y[t<span class="dv">-1</span>] <span class="sc">+</span> theta<span class="sc">*</span>epsilon[t<span class="dv">-1</span>] <span class="sc">+</span> epsilon[t]</span>
<span id="cb105-24"><a href="session07.html#cb105-24" tabindex="-1"></a>}</span>
<span id="cb105-25"><a href="session07.html#cb105-25" tabindex="-1"></a>y <span class="ot">&lt;-</span> y[<span class="dv">50</span><span class="sc">:</span>t_max]</span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="session07.html#cb106-1" tabindex="-1"></a><span class="co"># plot simulated series</span></span>
<span id="cb106-2"><a href="session07.html#cb106-2" tabindex="-1"></a><span class="fu">plot.ts</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="session07.html#cb107-1" tabindex="-1"></a><span class="co"># plot simulated series squared</span></span>
<span id="cb107-2"><a href="session07.html#cb107-2" tabindex="-1"></a><span class="fu">plot.ts</span>(y<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-75-2.png" width="672" /></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="session07.html#cb108-1" tabindex="-1"></a><span class="do">## filter </span></span>
<span id="cb108-2"><a href="session07.html#cb108-2" tabindex="-1"></a>arma11tgarch11_filter <span class="ot">&lt;-</span> <span class="cf">function</span>(y, params){</span>
<span id="cb108-3"><a href="session07.html#cb108-3" tabindex="-1"></a>  <span class="co"># initializations</span></span>
<span id="cb108-4"><a href="session07.html#cb108-4" tabindex="-1"></a>  c      <span class="ot">&lt;-</span> params[<span class="dv">1</span>]</span>
<span id="cb108-5"><a href="session07.html#cb108-5" tabindex="-1"></a>  phi    <span class="ot">&lt;-</span> params[<span class="dv">2</span>]</span>
<span id="cb108-6"><a href="session07.html#cb108-6" tabindex="-1"></a>  theta  <span class="ot">&lt;-</span> params[<span class="dv">3</span>]</span>
<span id="cb108-7"><a href="session07.html#cb108-7" tabindex="-1"></a>  omega  <span class="ot">&lt;-</span> params[<span class="dv">4</span>]</span>
<span id="cb108-8"><a href="session07.html#cb108-8" tabindex="-1"></a>  alpha  <span class="ot">&lt;-</span> params[<span class="dv">5</span>]</span>
<span id="cb108-9"><a href="session07.html#cb108-9" tabindex="-1"></a>  beta   <span class="ot">&lt;-</span> params[<span class="dv">6</span>]</span>
<span id="cb108-10"><a href="session07.html#cb108-10" tabindex="-1"></a>  gamma  <span class="ot">&lt;-</span> params[<span class="dv">7</span>]</span>
<span id="cb108-11"><a href="session07.html#cb108-11" tabindex="-1"></a>  t_max  <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb108-12"><a href="session07.html#cb108-12" tabindex="-1"></a>  </span>
<span id="cb108-13"><a href="session07.html#cb108-13" tabindex="-1"></a>  eps  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">rep</span>(<span class="cn">NA</span>, t_max<span class="dv">-1</span>))</span>
<span id="cb108-14"><a href="session07.html#cb108-14" tabindex="-1"></a>  sig2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">rep</span>(<span class="cn">NA</span>, t_max<span class="dv">-1</span>))</span>
<span id="cb108-15"><a href="session07.html#cb108-15" tabindex="-1"></a>  z    <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, t_max)</span>
<span id="cb108-16"><a href="session07.html#cb108-16" tabindex="-1"></a>  loglik <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb108-17"><a href="session07.html#cb108-17" tabindex="-1"></a>  sig2[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">var</span>(y)</span>
<span id="cb108-18"><a href="session07.html#cb108-18" tabindex="-1"></a>  z[<span class="dv">1</span>]    <span class="ot">&lt;-</span> y[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sqrt</span>(sig2[<span class="dv">1</span>])</span>
<span id="cb108-19"><a href="session07.html#cb108-19" tabindex="-1"></a>  <span class="co"># for loop calculating one-step-ahead</span></span>
<span id="cb108-20"><a href="session07.html#cb108-20" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>t_max){</span>
<span id="cb108-21"><a href="session07.html#cb108-21" tabindex="-1"></a>    eps[t]  <span class="ot">&lt;-</span> y[t] <span class="sc">-</span> c <span class="sc">-</span> phi<span class="sc">*</span>y[t<span class="dv">-1</span>] <span class="sc">-</span> theta<span class="sc">*</span>eps[t<span class="dv">-1</span>]</span>
<span id="cb108-22"><a href="session07.html#cb108-22" tabindex="-1"></a>    sig2[t] <span class="ot">&lt;-</span> omega <span class="sc">+</span> alpha<span class="sc">*</span>y[t<span class="dv">-1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> beta<span class="sc">*</span>sig2[t<span class="dv">-1</span>] <span class="sc">+</span> gamma<span class="sc">*</span>y[t<span class="dv">-1</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(y[t<span class="dv">-1</span>]<span class="sc">&lt;</span><span class="dv">0</span>)</span>
<span id="cb108-23"><a href="session07.html#cb108-23" tabindex="-1"></a>    z[t]    <span class="ot">&lt;-</span> eps[t]<span class="sc">/</span><span class="fu">sqrt</span>(sig2[t])</span>
<span id="cb108-24"><a href="session07.html#cb108-24" tabindex="-1"></a>  }</span>
<span id="cb108-25"><a href="session07.html#cb108-25" tabindex="-1"></a>  <span class="co"># loglik</span></span>
<span id="cb108-26"><a href="session07.html#cb108-26" tabindex="-1"></a>  loglik <span class="ot">&lt;-</span>  <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">log</span>(sig2[<span class="dv">2</span><span class="sc">:</span>t_max])) <span class="sc">-</span> <span class="fu">sum</span>(eps[<span class="dv">2</span><span class="sc">:</span>t_max]<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>sig2[<span class="dv">2</span><span class="sc">:</span>t_max])  <span class="co"># *0.5 + constant terms </span></span>
<span id="cb108-27"><a href="session07.html#cb108-27" tabindex="-1"></a>  </span>
<span id="cb108-28"><a href="session07.html#cb108-28" tabindex="-1"></a>  <span class="co"># output</span></span>
<span id="cb108-29"><a href="session07.html#cb108-29" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">sig2   =</span> sig2, </span>
<span id="cb108-30"><a href="session07.html#cb108-30" tabindex="-1"></a>              <span class="at">eps    =</span> eps,</span>
<span id="cb108-31"><a href="session07.html#cb108-31" tabindex="-1"></a>              <span class="at">z      =</span> z, </span>
<span id="cb108-32"><a href="session07.html#cb108-32" tabindex="-1"></a>              <span class="at">loglik =</span> loglik))</span>
<span id="cb108-33"><a href="session07.html#cb108-33" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="session07.html#cb109-1" tabindex="-1"></a><span class="do">## likelihood</span></span>
<span id="cb109-2"><a href="session07.html#cb109-2" tabindex="-1"></a>arma11tgarch11_objective <span class="ot">&lt;-</span> <span class="cf">function</span>(y, params) {</span>
<span id="cb109-3"><a href="session07.html#cb109-3" tabindex="-1"></a>  <span class="co">#initializations</span></span>
<span id="cb109-4"><a href="session07.html#cb109-4" tabindex="-1"></a>  c      <span class="ot">&lt;-</span> params[<span class="dv">1</span>]</span>
<span id="cb109-5"><a href="session07.html#cb109-5" tabindex="-1"></a>  phi    <span class="ot">&lt;-</span> params[<span class="dv">2</span>]</span>
<span id="cb109-6"><a href="session07.html#cb109-6" tabindex="-1"></a>  theta  <span class="ot">&lt;-</span> params[<span class="dv">3</span>]</span>
<span id="cb109-7"><a href="session07.html#cb109-7" tabindex="-1"></a>  omega  <span class="ot">&lt;-</span> params[<span class="dv">4</span>]</span>
<span id="cb109-8"><a href="session07.html#cb109-8" tabindex="-1"></a>  alpha  <span class="ot">&lt;-</span> params[<span class="dv">5</span>]</span>
<span id="cb109-9"><a href="session07.html#cb109-9" tabindex="-1"></a>  beta   <span class="ot">&lt;-</span> params[<span class="dv">6</span>]</span>
<span id="cb109-10"><a href="session07.html#cb109-10" tabindex="-1"></a>  gamma  <span class="ot">&lt;-</span> params[<span class="dv">7</span>]</span>
<span id="cb109-11"><a href="session07.html#cb109-11" tabindex="-1"></a>  t_max  <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb109-12"><a href="session07.html#cb109-12" tabindex="-1"></a>  res_filter <span class="ot">&lt;-</span> <span class="fu">arma11tgarch11_filter</span>(y, params)</span>
<span id="cb109-13"><a href="session07.html#cb109-13" tabindex="-1"></a>  sig2 <span class="ot">&lt;-</span> res_filter<span class="sc">$</span>sig2</span>
<span id="cb109-14"><a href="session07.html#cb109-14" tabindex="-1"></a>  eps <span class="ot">&lt;-</span> res_filter<span class="sc">$</span>eps</span>
<span id="cb109-15"><a href="session07.html#cb109-15" tabindex="-1"></a>  </span>
<span id="cb109-16"><a href="session07.html#cb109-16" tabindex="-1"></a>  <span class="co"># if-else statement calculating negative loglik</span></span>
<span id="cb109-17"><a href="session07.html#cb109-17" tabindex="-1"></a>  <span class="co"># if (all(is.finite(params)) &amp; omega&gt;=0 &amp; alpha&gt;0 &amp; beta&gt;0 &amp; gamma&gt;0 &amp; (alpha+beta+gamma/2)&lt;1) {</span></span>
<span id="cb109-18"><a href="session07.html#cb109-18" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">is.finite</span>(params)) <span class="sc">&amp;</span> (alpha<span class="sc">+</span>beta<span class="sc">+</span>gamma<span class="sc">/</span><span class="dv">2</span>)<span class="sc">&lt;</span><span class="dv">1</span>) {</span>
<span id="cb109-19"><a href="session07.html#cb109-19" tabindex="-1"></a>    neg_loglik <span class="ot">&lt;-</span> <span class="sc">-</span>res_filter<span class="sc">$</span>loglik</span>
<span id="cb109-20"><a href="session07.html#cb109-20" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb109-21"><a href="session07.html#cb109-21" tabindex="-1"></a>    neg_loglik <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb109-22"><a href="session07.html#cb109-22" tabindex="-1"></a>  }</span>
<span id="cb109-23"><a href="session07.html#cb109-23" tabindex="-1"></a>  <span class="fu">return</span>(neg_loglik)</span>
<span id="cb109-24"><a href="session07.html#cb109-24" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="session07.html#cb110-1" tabindex="-1"></a><span class="do">## MLE</span></span>
<span id="cb110-2"><a href="session07.html#cb110-2" tabindex="-1"></a>arma11tgarch11_mle <span class="ot">&lt;-</span> <span class="cf">function</span>(y, params) {</span>
<span id="cb110-3"><a href="session07.html#cb110-3" tabindex="-1"></a>  <span class="co"># nlminb function optimizing parameters </span></span>
<span id="cb110-4"><a href="session07.html#cb110-4" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">nlminb</span>(<span class="at">start =</span> params, <span class="at">objective =</span> arma11tgarch11_objective, </span>
<span id="cb110-5"><a href="session07.html#cb110-5" tabindex="-1"></a>                <span class="at">y =</span> y, </span>
<span id="cb110-6"><a href="session07.html#cb110-6" tabindex="-1"></a>                <span class="at">lower =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.999</span>, <span class="sc">-</span><span class="fl">0.999</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>), </span>
<span id="cb110-7"><a href="session07.html#cb110-7" tabindex="-1"></a>                <span class="at">upper =</span> <span class="fu">c</span>( <span class="dv">1</span>,  <span class="fl">0.999</span>,  <span class="fl">0.999</span>,  <span class="dv">1</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>))</span>
<span id="cb110-8"><a href="session07.html#cb110-8" tabindex="-1"></a></span>
<span id="cb110-9"><a href="session07.html#cb110-9" tabindex="-1"></a>  <span class="do">## output</span></span>
<span id="cb110-10"><a href="session07.html#cb110-10" tabindex="-1"></a>  <span class="fu">names</span>(fit<span class="sc">$</span>par) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;phi&quot;</span>, <span class="st">&quot;theta&quot;</span>, <span class="st">&quot;omega&quot;</span>, <span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb110-11"><a href="session07.html#cb110-11" tabindex="-1"></a>  fit<span class="sc">$</span>par</span>
<span id="cb110-12"><a href="session07.html#cb110-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="session07.html#cb111-1" tabindex="-1"></a>startparams <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.9</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="fl">0.01</span>)</span>
<span id="cb111-2"><a href="session07.html#cb111-2" tabindex="-1"></a>mle <span class="ot">&lt;-</span> <span class="fu">arma11tgarch11_mle</span>(y, startparams)</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="session07.html#cb112-1" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">MLE =</span> mle, </span>
<span id="cb112-2"><a href="session07.html#cb112-2" tabindex="-1"></a>             <span class="at">true =</span> <span class="fu">c</span>(c, phi, theta, omega, alpha, beta, gamma))</span>
<span id="cb112-3"><a href="session07.html#cb112-3" tabindex="-1"></a><span class="fu">row.names</span>(tab) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;phi&quot;</span>, <span class="st">&quot;theta&quot;</span>, <span class="st">&quot;omega&quot;</span>, <span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb112-4"><a href="session07.html#cb112-4" tabindex="-1"></a><span class="fu">round</span>(tab, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##          MLE  true
## c      0.001  0.00
## phi    0.831  0.85
## theta -0.119 -0.10
## omega  0.001  0.01
## alpha  0.028  0.10
## beta   0.736  0.85
## gamma  0.009  0.05</code></pre>
</div>
<div id="modeling-the-sp-500-volatility" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Modeling the S&amp;P 500 volatility<a href="session07.html#modeling-the-sp-500-volatility" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now show an application of the ARMA(1,1)-TGARCH(1,1) model to the S&amp;P 500 historical data.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="session07.html#cb114-1" tabindex="-1"></a><span class="do">## Load data</span></span>
<span id="cb114-2"><a href="session07.html#cb114-2" tabindex="-1"></a>sp500 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../data/sp500.csv&quot;</span>)</span>
<span id="cb114-3"><a href="session07.html#cb114-3" tabindex="-1"></a>sp500 <span class="ot">&lt;-</span> <span class="fu">ts</span>(sp500<span class="sc">$</span>adjusted_close[<span class="fu">nrow</span>(sp500)<span class="sc">:</span><span class="dv">1</span>], <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1999</span>, <span class="dv">11</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">365</span>)</span>
<span id="cb114-4"><a href="session07.html#cb114-4" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(sp500))<span class="sc">*</span><span class="dv">252</span></span>
<span id="cb114-5"><a href="session07.html#cb114-5" tabindex="-1"></a><span class="fu">plot.ts</span>(d, <span class="at">main =</span> <span class="st">&quot;S&amp;P 500 annualized growth rates&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="session07.html#cb115-1" tabindex="-1"></a><span class="do">## Compute MLE</span></span>
<span id="cb115-2"><a href="session07.html#cb115-2" tabindex="-1"></a>mle_sp500 <span class="ot">&lt;-</span> <span class="fu">arma11tgarch11_mle</span>(d, startparams)</span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="session07.html#cb116-1" tabindex="-1"></a>mle_sp500</span></code></pre></div>
<pre><code>##           c         phi       theta       omega       alpha        beta 
##  0.03314379  0.49055508 -0.53153704  0.16230434  0.01000000  0.87320296 
##       gamma 
##  0.19467830</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="session07.html#cb118-1" tabindex="-1"></a><span class="do">## plot fitted values</span></span>
<span id="cb118-2"><a href="session07.html#cb118-2" tabindex="-1"></a>filter_sp500 <span class="ot">&lt;-</span> <span class="fu">arma11tgarch11_filter</span>(d, mle_sp500)</span>
<span id="cb118-3"><a href="session07.html#cb118-3" tabindex="-1"></a>eps  <span class="ot">&lt;-</span> filter_sp500<span class="sc">$</span>eps</span>
<span id="cb118-4"><a href="session07.html#cb118-4" tabindex="-1"></a>sig2 <span class="ot">&lt;-</span> filter_sp500<span class="sc">$</span>sig2</span>
<span id="cb118-5"><a href="session07.html#cb118-5" tabindex="-1"></a>z    <span class="ot">&lt;-</span> filter_sp500<span class="sc">$</span>z</span>
<span id="cb118-6"><a href="session07.html#cb118-6" tabindex="-1"></a></span>
<span id="cb118-7"><a href="session07.html#cb118-7" tabindex="-1"></a>c      <span class="ot">&lt;-</span> mle_sp500[<span class="dv">1</span>]</span>
<span id="cb118-8"><a href="session07.html#cb118-8" tabindex="-1"></a>phi    <span class="ot">&lt;-</span> mle_sp500[<span class="dv">2</span>]</span>
<span id="cb118-9"><a href="session07.html#cb118-9" tabindex="-1"></a>theta  <span class="ot">&lt;-</span> mle_sp500[<span class="dv">3</span>]</span>
<span id="cb118-10"><a href="session07.html#cb118-10" tabindex="-1"></a>omega  <span class="ot">&lt;-</span> mle_sp500[<span class="dv">4</span>]</span>
<span id="cb118-11"><a href="session07.html#cb118-11" tabindex="-1"></a>alpha  <span class="ot">&lt;-</span> mle_sp500[<span class="dv">5</span>]</span>
<span id="cb118-12"><a href="session07.html#cb118-12" tabindex="-1"></a>beta   <span class="ot">&lt;-</span> mle_sp500[<span class="dv">6</span>]</span>
<span id="cb118-13"><a href="session07.html#cb118-13" tabindex="-1"></a>gamma  <span class="ot">&lt;-</span> mle_sp500[<span class="dv">7</span>]</span>
<span id="cb118-14"><a href="session07.html#cb118-14" tabindex="-1"></a>t_max  <span class="ot">&lt;-</span> <span class="fu">length</span>(d)</span>
<span id="cb118-15"><a href="session07.html#cb118-15" tabindex="-1"></a></span>
<span id="cb118-16"><a href="session07.html#cb118-16" tabindex="-1"></a>fitted_sp500 <span class="ot">&lt;-</span> c <span class="sc">+</span> phi<span class="sc">*</span>d <span class="sc">+</span> theta<span class="sc">*</span>eps</span>
<span id="cb118-17"><a href="session07.html#cb118-17" tabindex="-1"></a>upper_sp500     <span class="ot">&lt;-</span> fitted_sp500 <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(sig2)</span>
<span id="cb118-18"><a href="session07.html#cb118-18" tabindex="-1"></a>lower_sp500     <span class="ot">&lt;-</span> fitted_sp500 <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(sig2)</span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="session07.html#cb119-1" tabindex="-1"></a><span class="fu">plot.ts</span>(d, <span class="at">main =</span> <span class="st">&quot;S&amp;P 500 annualized growth rates&quot;</span>)</span>
<span id="cb119-2"><a href="session07.html#cb119-2" tabindex="-1"></a><span class="fu">lines</span>(fitted_sp500, <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb119-3"><a href="session07.html#cb119-3" tabindex="-1"></a><span class="fu">lines</span>(lower_sp500, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb119-4"><a href="session07.html#cb119-4" tabindex="-1"></a><span class="fu">lines</span>(upper_sp500, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb119-5"><a href="session07.html#cb119-5" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">2009</span>, <span class="at">y =</span> <span class="dv">30</span>,</span>
<span id="cb119-6"><a href="session07.html#cb119-6" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">&quot;Observations outside CI: &quot;</span>, </span>
<span id="cb119-7"><a href="session07.html#cb119-7" tabindex="-1"></a>                   <span class="fu">round</span>(<span class="fu">mean</span>((d <span class="sc">&gt;</span> upper_sp500) <span class="sc">|</span> (d <span class="sc">&lt;</span> lower_sp500)),<span class="dv">4</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
<div id="exercises-3" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Exercises<a href="session07.html#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Exercise 1 (h-step ahead volatility forecast of the GARCH(1,1))</strong></p>
<p>Consider the GARCH(1,1) model</p>
<p><span class="math display">\[
\begin{aligned}
r_t &amp;= \sigma^2_t z_t \\[1ex]
\sigma^2_t &amp;= \omega + \alpha r_{t-1}^2 + \beta \sigma^2_{t-1}
\end{aligned}
\]</span></p>
<p>Show that</p>
<p><span class="math display">\[
\mathbb{E}[\sigma^2_{t+h} | r_t, \sigma_t] =
\begin{cases}
\omega + \alpha r_{t}^2 + \beta \sigma^2_t &amp; \qquad \text{if} \quad h=1 \\
\omega \frac{1-(\alpha+\beta)^{h-1}}{1-\alpha-\beta} + (\alpha+\beta)^{h-1} \
\mathbb{E}[\sigma^2_{t+1} | r_t, \sigma_t]  &amp; \qquad \text{if} \quad h&gt;1
\end{cases}
\]</span></p>
<p><br>
<br></p>
<p><strong>Exercise 2 (Log-likelihood of the ARMA(p,q)-GARCH(r,s) model)</strong></p>
<p>Consider the following specification of an ARMA model with conditionally-heteroskedastic innovations:</p>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;= c + \phi_1 y_{t-1} + \dots + \phi_p y_{t-p} + \theta_1 \varepsilon_{t-1} + \dots + \theta_q \varepsilon_{t-q} + \varepsilon_t \\
\varepsilon_t &amp;= \sigma_t z_t \\
\sigma^2_t &amp;= \omega + \alpha_1 y_{t-1}^2 + \dots + \alpha_r y_{t-r}^2 + \beta_1 \sigma^2_{t-1} + \dots + \beta_s \sigma^2_{t-s}
\end{aligned}
\]</span></p>
<p>Derive the log-likelihood of the model under the assumption that <span class="math inline">\(z_t \sim \mathcal{N}(0, 1)\)</span>. Provide also the filtering procedure used to estimate the latent variables <span class="math inline">\(\varepsilon_t\)</span> and <span class="math inline">\(\sigma_t\)</span>.</p>
<p><br>
<br></p>
<p><strong>Exercise 3 (Log-likelihood of the ARMA(1,1)-TGARCH(1,1) model)</strong></p>
<p>Consider the following specification of an ARMA model with asymmetric conditionally-heteroskedastic innovations:</p>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;= c + \phi y_{t-1} + \theta \varepsilon_{t-1} + \varepsilon_t \\
\varepsilon_t &amp;= \sigma_t z_t \\
\sigma^2_t &amp;= \omega + \alpha y_{t-1}^2 + \beta \sigma^2_{t-1} + \gamma y_{t-1}^2 \mathbb{1}_{y_{t-1}&lt;0}
\end{aligned}
\]</span></p>
<p>Derive the log-likelihood of the model under the assumption that <span class="math inline">\(z_t \sim \mathcal{N}(0, 1)\)</span>. Provide also the filtering procedure used to estimate the latent variables <span class="math inline">\(\varepsilon_t\)</span> and <span class="math inline">\(\sigma_t\)</span>.</p>
<p><br>
<br></p>
<!--  -->
<!-- # References {-} -->
<!--  -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="session06.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="session08.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aciancetta/finmetrics/edit/BRANCH/07-session07.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
