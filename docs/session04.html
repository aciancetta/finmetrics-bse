<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Session 4 ARMA(1,1) model | Financial Econometrics - Tutorials</title>
  <meta name="description" content="TA materials for the Financial Econometrics course held by Prof. Christian Brownlees at the Barcelona School of Economics." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Session 4 ARMA(1,1) model | Financial Econometrics - Tutorials" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="TA materials for the Financial Econometrics course held by Prof. Christian Brownlees at the Barcelona School of Economics." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Session 4 ARMA(1,1) model | Financial Econometrics - Tutorials" />
  
  <meta name="twitter:description" content="TA materials for the Financial Econometrics course held by Prof. Christian Brownlees at the Barcelona School of Economics." />
  

<meta name="author" content="Alessandro Ciancetta" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="session03.html"/>
<link rel="next" href="session05.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Financial Econometrics at BSE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="session01.html"><a href="session01.html"><i class="fa fa-check"></i><b>1</b> Introduction to time series</a>
<ul>
<li class="chapter" data-level="1.1" data-path="session01.html"><a href="session01.html#stochastic-processes-and-dependence"><i class="fa fa-check"></i><b>1.1</b> Stochastic processes and dependence</a>
<ul>
<li class="chapter" data-level="" data-path="session01.html"><a href="session01.html#stationarity"><i class="fa fa-check"></i>Stationarity</a></li>
<li class="chapter" data-level="" data-path="session01.html"><a href="session01.html#ergodicity"><i class="fa fa-check"></i>Ergodicity</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="session01.html"><a href="session01.html#asymptotic-results"><i class="fa fa-check"></i><b>1.2</b> Asymptotic results</a></li>
<li class="chapter" data-level="1.3" data-path="session01.html"><a href="session01.html#empirical-moments-and-summary-statistics"><i class="fa fa-check"></i><b>1.3</b> Empirical moments and summary statistics</a></li>
<li class="chapter" data-level="1.4" data-path="session01.html"><a href="session01.html#hypothesis-testing"><i class="fa fa-check"></i><b>1.4</b> Hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="session02.html"><a href="session02.html"><i class="fa fa-check"></i><b>2</b> Forecasting with time-series regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="session02.html"><a href="session02.html#oracle-inequality"><i class="fa fa-check"></i><b>2.1</b> Oracle inequality</a></li>
<li class="chapter" data-level="2.2" data-path="session02.html"><a href="session02.html#application-forecasting-unemployment"><i class="fa fa-check"></i><b>2.2</b> Application: forecasting unemployment</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="session03.html"><a href="session03.html"><i class="fa fa-check"></i><b>3</b> Large-dimensional methods for forecasting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="session03.html"><a href="session03.html#preprocess-fred-md"><i class="fa fa-check"></i><b>3.1</b> Preprocess FRED-MD</a></li>
<li class="chapter" data-level="3.2" data-path="session03.html"><a href="session03.html#forecasting-algorithms"><i class="fa fa-check"></i><b>3.2</b> Forecasting algorithms</a></li>
<li class="chapter" data-level="3.3" data-path="session03.html"><a href="session03.html#forecast-evaluation"><i class="fa fa-check"></i><b>3.3</b> Forecast evaluation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="session04.html"><a href="session04.html"><i class="fa fa-check"></i><b>4</b> ARMA(1,1) model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="session04.html"><a href="session04.html#mle-for-the-arma11"><i class="fa fa-check"></i><b>4.1</b> MLE for the ARMA(1,1)</a></li>
<li class="chapter" data-level="4.2" data-path="session04.html"><a href="session04.html#exercises"><i class="fa fa-check"></i><b>4.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="session05.html"><a href="session05.html"><i class="fa fa-check"></i><b>5</b> ARMA models in practice</a>
<ul>
<li class="chapter" data-level="5.1" data-path="session05.html"><a href="session05.html#forecasting-the-u.s.-gdp-growth"><i class="fa fa-check"></i><b>5.1</b> Forecasting the U.S. GDP growth</a></li>
<li class="chapter" data-level="5.2" data-path="session05.html"><a href="session05.html#exercises-1"><i class="fa fa-check"></i><b>5.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="session06.html"><a href="session06.html"><i class="fa fa-check"></i><b>6</b> Volatility modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="session06.html"><a href="session06.html#garch11-estimation"><i class="fa fa-check"></i><b>6.1</b> GARCH(1,1) estimation</a></li>
<li class="chapter" data-level="6.2" data-path="session06.html"><a href="session06.html#exercises-2"><i class="fa fa-check"></i><b>6.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="session07.html"><a href="session07.html"><i class="fa fa-check"></i><b>7</b> Volatility modeling in practice</a>
<ul>
<li class="chapter" data-level="7.1" data-path="session07.html"><a href="session07.html#the-arma11-tgarch11-model"><i class="fa fa-check"></i><b>7.1</b> The ARMA(1,1)-TGARCH(1,1) model</a></li>
<li class="chapter" data-level="7.2" data-path="session07.html"><a href="session07.html#modeling-the-sp-500-volatility"><i class="fa fa-check"></i><b>7.2</b> Modeling the S&amp;P 500 volatility</a></li>
<li class="chapter" data-level="7.3" data-path="session07.html"><a href="session07.html#exercises-3"><i class="fa fa-check"></i><b>7.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="session08.html"><a href="session08.html"><i class="fa fa-check"></i><b>8</b> Value-at-Risk and correlation modelling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="session08.html"><a href="session08.html#exercises-4"><i class="fa fa-check"></i><b>8.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="session09.html"><a href="session09.html"><i class="fa fa-check"></i><b>9</b> Additional exercises</a>
<ul>
<li class="chapter" data-level="9.1" data-path="session09.html"><a href="session09.html#exercises-5"><i class="fa fa-check"></i><b>9.1</b> Exercises</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/aciancetta" target="blank">Alessandro Ciancetta</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Financial Econometrics - Tutorials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="session04" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Session 4</span> ARMA(1,1) model<a href="session04.html#session04" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="mle-for-the-arma11" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> MLE for the ARMA(1,1)<a href="session04.html#mle-for-the-arma11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this session we consider the ARMA(1,1) model:</p>
<p><span class="math display">\[
y_t = c + \phi y_{t-1} + \theta \varepsilon_{t-1} + \varepsilon_t, \quad \varepsilon_t \sim WN(0, \sigma^2_\varepsilon)
\]</span></p>
<p>Below we simulate an ARMA(1,1) model with Gaussian iid noise terms: <span class="math inline">\(\varepsilon_t \sim \mathcal{N}(0, \sigma^2_\varepsilon)\)</span>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="session04.html#cb76-1" tabindex="-1"></a><span class="do">## Setup parameters for simulation</span></span>
<span id="cb76-2"><a href="session04.html#cb76-2" tabindex="-1"></a>t_max <span class="ot">&lt;-</span> <span class="dv">800</span></span>
<span id="cb76-3"><a href="session04.html#cb76-3" tabindex="-1"></a>y0    <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb76-4"><a href="session04.html#cb76-4" tabindex="-1"></a>const <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb76-5"><a href="session04.html#cb76-5" tabindex="-1"></a>phi   <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb76-6"><a href="session04.html#cb76-6" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb76-7"><a href="session04.html#cb76-7" tabindex="-1"></a>sigma_eps <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-8"><a href="session04.html#cb76-8" tabindex="-1"></a></span>
<span id="cb76-9"><a href="session04.html#cb76-9" tabindex="-1"></a><span class="do">## Simulation ARMA(1,1)</span></span>
<span id="cb76-10"><a href="session04.html#cb76-10" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(t_max<span class="sc">+</span><span class="dv">1</span>, <span class="at">sd =</span> sigma_eps)</span>
<span id="cb76-11"><a href="session04.html#cb76-11" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb76-12"><a href="session04.html#cb76-12" tabindex="-1"></a>y[<span class="dv">1</span>] <span class="ot">&lt;-</span> y0</span>
<span id="cb76-13"><a href="session04.html#cb76-13" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>t_max) {</span>
<span id="cb76-14"><a href="session04.html#cb76-14" tabindex="-1"></a>  y[t] <span class="ot">&lt;-</span> const <span class="sc">+</span> phi<span class="sc">*</span>y[t<span class="dv">-1</span>] <span class="sc">+</span> theta<span class="sc">*</span>eps[t<span class="dv">-1</span>] <span class="sc">+</span> eps[t]</span>
<span id="cb76-15"><a href="session04.html#cb76-15" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="session04.html#cb77-1" tabindex="-1"></a><span class="fu">plot.ts</span>(y)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="session04.html#cb78-1" tabindex="-1"></a><span class="do">## Autocorrelograms</span></span>
<span id="cb78-2"><a href="session04.html#cb78-2" tabindex="-1"></a><span class="fu">acf</span>(y, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="session04.html#cb79-1" tabindex="-1"></a><span class="fu">pacf</span>(y, <span class="at">lwd =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-57-2.png" width="672" /></p>
<p>We now turn to estimate the model by maximum likelihood. We can then compare the estimates with the true values of the parameters that we used to simulate the data. Notice that the distribution of observation <span class="math inline">\(y_t\)</span> given all the information set <span class="math inline">\(I_{t-1}\)</span> available up to time <span class="math inline">\(t-1\)</span> is</p>
<p><span class="math display">\[
y_t | I_{t-1} \sim \mathcal{N}(c + \phi y_{t-1} + \theta \varepsilon_{t-1}, \ \sigma^2_\varepsilon).
\]</span></p>
<p>Let $ = (c, , , ^2_)$ denote the vector of parameters of the model. The <em>conditional</em> likelihood can be obtained as:</p>
<p><span class="math display">\[
L(\eta; y_1, \dots, y_T) = \prod_{t=2}^T \frac{1}{\sqrt{2\pi\sigma^2_{\varepsilon}}} \exp\left( -\frac{1}{2\sigma^2_\varepsilon} (y_t - c - \phi y_{t-1} - \theta \varepsilon_{t-1} )^2  \right)
\]</span></p>
<p>where the conditioning is on the first observation <span class="math inline">\(y_1\)</span>. Taking the logarithm and defining <span class="math inline">\(\hat \varepsilon_t = y_t - c - \phi y_{t-1} - \theta \varepsilon_{t-1}\)</span> we get</p>
<p><span class="math display">\[
\ell(\eta ;  y_1, \dots, y_T)  =  - \frac{T-1}{2} \log(2\pi\sigma^2_\varepsilon) - \frac{1}{2\sigma^2_\varepsilon} \sum_{t=2}^T \hat\varepsilon_t^2
\]</span></p>
<p>The estimate of the innovations can be obtained using a filtering procedure: for a given value of the parameters <span class="math inline">\(\eta = (c, \phi, \theta, \sigma^2_\varepsilon)\)</span>, we set <span class="math inline">\(\hat\varepsilon_1\)</span> equal to the deviation from the unconditional mean of the first observation, <span class="math inline">\(\hat\varepsilon_1 = y_1 - \frac{c}{1-\phi}\)</span>, and then we compute <span class="math inline">\(\hat\varepsilon_{t} = y_t - c - \phi y_{t-1} + \theta \hat\varepsilon_{t-1}\)</span> recursively for <span class="math inline">\(t = 2, \dots, T\)</span>. Then we can use the estimated sequence of innovations <span class="math inline">\(\{\hat\varepsilon_t\}_{t=2}^T\)</span> to evaluate the log-likelihood in <span class="math inline">\(\eta\)</span>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="session04.html#cb80-1" tabindex="-1"></a><span class="do">## Estimation: filtering</span></span>
<span id="cb80-2"><a href="session04.html#cb80-2" tabindex="-1"></a></span>
<span id="cb80-3"><a href="session04.html#cb80-3" tabindex="-1"></a><span class="do">## 1-step ahead conditional mean of ARMA(1,1) model</span></span>
<span id="cb80-4"><a href="session04.html#cb80-4" tabindex="-1"></a>arma_filter <span class="ot">&lt;-</span> <span class="cf">function</span>(x, params){</span>
<span id="cb80-5"><a href="session04.html#cb80-5" tabindex="-1"></a>  <span class="co"># get parameters</span></span>
<span id="cb80-6"><a href="session04.html#cb80-6" tabindex="-1"></a>  const <span class="ot">&lt;-</span> params[<span class="dv">1</span>]</span>
<span id="cb80-7"><a href="session04.html#cb80-7" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> params[<span class="dv">2</span>]</span>
<span id="cb80-8"><a href="session04.html#cb80-8" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> params[<span class="dv">3</span>]</span>
<span id="cb80-9"><a href="session04.html#cb80-9" tabindex="-1"></a></span>
<span id="cb80-10"><a href="session04.html#cb80-10" tabindex="-1"></a>  <span class="do">## initialize intercept, innovation</span></span>
<span id="cb80-11"><a href="session04.html#cb80-11" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x))</span>
<span id="cb80-12"><a href="session04.html#cb80-12" tabindex="-1"></a>  mu[<span class="dv">1</span>] <span class="ot">&lt;-</span> const<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>phi)</span>
<span id="cb80-13"><a href="session04.html#cb80-13" tabindex="-1"></a>  eps <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x))</span>
<span id="cb80-14"><a href="session04.html#cb80-14" tabindex="-1"></a>  eps[<span class="dv">1</span>] <span class="ot">&lt;-</span> x[<span class="dv">1</span>] <span class="sc">-</span> mu[<span class="dv">1</span>]</span>
<span id="cb80-15"><a href="session04.html#cb80-15" tabindex="-1"></a></span>
<span id="cb80-16"><a href="session04.html#cb80-16" tabindex="-1"></a>  <span class="co"># filter and innovations</span></span>
<span id="cb80-17"><a href="session04.html#cb80-17" tabindex="-1"></a>  <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb80-18"><a href="session04.html#cb80-18" tabindex="-1"></a>    mu[t] <span class="ot">&lt;-</span> const <span class="sc">+</span> phi<span class="sc">*</span>x[t<span class="dv">-1</span>] <span class="sc">+</span> theta<span class="sc">*</span>eps[t<span class="dv">-1</span>]</span>
<span id="cb80-19"><a href="session04.html#cb80-19" tabindex="-1"></a>    eps[t] <span class="ot">&lt;-</span> x[t] <span class="sc">-</span> mu[t]</span>
<span id="cb80-20"><a href="session04.html#cb80-20" tabindex="-1"></a>  }</span>
<span id="cb80-21"><a href="session04.html#cb80-21" tabindex="-1"></a></span>
<span id="cb80-22"><a href="session04.html#cb80-22" tabindex="-1"></a>  <span class="co"># output: estimated innovations</span></span>
<span id="cb80-23"><a href="session04.html#cb80-23" tabindex="-1"></a>  eps</span>
<span id="cb80-24"><a href="session04.html#cb80-24" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="session04.html#cb81-1" tabindex="-1"></a>arma_loglik <span class="ot">&lt;-</span> <span class="cf">function</span>(x, params){</span>
<span id="cb81-2"><a href="session04.html#cb81-2" tabindex="-1"></a>  <span class="co"># params now include (c, phi, theta, sigma2)</span></span>
<span id="cb81-3"><a href="session04.html#cb81-3" tabindex="-1"></a>  t_max <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb81-4"><a href="session04.html#cb81-4" tabindex="-1"></a>  sigma2 <span class="ot">&lt;-</span> params[<span class="dv">4</span>]</span>
<span id="cb81-5"><a href="session04.html#cb81-5" tabindex="-1"></a>  eps <span class="ot">&lt;-</span> <span class="fu">arma_filter</span>(x, params[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb81-6"><a href="session04.html#cb81-6" tabindex="-1"></a></span>
<span id="cb81-7"><a href="session04.html#cb81-7" tabindex="-1"></a>  <span class="co"># compute loglik</span></span>
<span id="cb81-8"><a href="session04.html#cb81-8" tabindex="-1"></a>  loglik <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>t_max<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>sigma2) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma2))<span class="sc">*</span><span class="fu">sum</span>(eps<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb81-9"><a href="session04.html#cb81-9" tabindex="-1"></a>  </span>
<span id="cb81-10"><a href="session04.html#cb81-10" tabindex="-1"></a>  <span class="co"># nlm() minimizes functions --&gt; we swap the sign of the log-likelihood</span></span>
<span id="cb81-11"><a href="session04.html#cb81-11" tabindex="-1"></a>  <span class="co"># (max L = min -L)</span></span>
<span id="cb81-12"><a href="session04.html#cb81-12" tabindex="-1"></a>  <span class="sc">-</span>loglik</span>
<span id="cb81-13"><a href="session04.html#cb81-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="session04.html#cb82-1" tabindex="-1"></a><span class="do">## estimation</span></span>
<span id="cb82-2"><a href="session04.html#cb82-2" tabindex="-1"></a>param_estim <span class="ot">&lt;-</span> <span class="fu">nlm</span>(arma_loglik, <span class="at">p =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">x =</span> y)<span class="sc">$</span>estimate</span></code></pre></div>
<pre><code>## Warning in nlm(arma_loglik, p = c(0, 0.1, 0, 1), x = y): NA/Inf sostituito da
## valore massimo positivo

## Warning in nlm(arma_loglik, p = c(0, 0.1, 0, 1), x = y): NA/Inf sostituito da
## valore massimo positivo

## Warning in nlm(arma_loglik, p = c(0, 0.1, 0, 1), x = y): NA/Inf sostituito da
## valore massimo positivo</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="session04.html#cb84-1" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">c</span>(const, phi, theta, sigma_eps), <span class="fu">round</span>(param_estim, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1]   [,2]
## [1,]  0.0 -0.005
## [2,]  0.9  0.873
## [3,] -0.5 -0.515
## [4,]  1.0  1.030</code></pre>
</div>
<div id="exercises" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Exercises<a href="session04.html#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Exercise 1 (LASSO as OLS with thresholding)</strong></p>
<p>Consider the linear regression model <span class="math inline">\(y = X\beta + \varepsilon\)</span> with uncorrelated regressors: <span class="math inline">\(X&#39;X = I_n\)</span>, where <span class="math inline">\(X\in\mathbb{R}^{T\times n}\)</span>. Show that the LASSO estimator
<span class="math display">\[
\hat\beta^{(\lambda)} = \arg\min_{\beta \in \mathbb{R}^n} \ (y-X\beta)&#39;(y-X\beta) + \lambda ||\beta||_1
\]</span>
can be written as</p>
<p><span class="math display">\[
\hat\beta_j^{(\lambda)} =
\begin{cases}
\hat\beta_j^{OLS} - \frac{\lambda}{2} &amp; \qquad \text{if} \quad \hat\beta_j^{OLS} &gt;  \frac{\lambda}{2} \\
\hat\beta_j^{OLS} + \frac{\lambda}{2} &amp; \qquad \text{if} \quad \hat\beta_j^{OLS} &lt;  -\frac{\lambda}{2} \\
0 &amp; \qquad \text{if} \quad \hat\beta_j^{OLS} \in  \left[ -\frac{\lambda}{2}, \frac{\lambda}{2} \right]\\
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(\hat\beta_j^{OLS}\)</span> denotes the <span class="math inline">\(j\)</span>-th entry of the OLS estimator and <span class="math inline">\(j = 1, \dots, n\)</span>.</p>
<p><br>
<br></p>
<p><strong>Exercise 2 (MA(<span class="math inline">\(\infty\)</span>) representation of stationary ARMA(1,1))</strong></p>
<p>Show that the ARMA(1,1) process with <span class="math inline">\(|\phi| &lt; 1\)</span></p>
<p><span class="math display">\[
y_t = c + \phi y_{t-1} + \theta \varepsilon_{t-1} + \varepsilon_t, \quad \varepsilon_t \sim WN(0, \sigma^2_\varepsilon)
\]</span></p>
<p>can be rewritten as</p>
<p><span class="math display">\[
y_t = \mu + \sum_{j=0}^\infty \psi_j \varepsilon_{t-j},
\]</span></p>
<p>for <span class="math inline">\(\mu = \frac{c}{1-\phi}\)</span>, <span class="math inline">\(\psi_0 = 1\)</span>, <span class="math inline">\(\psi_j = (\phi + \theta)\phi^{j-1}\)</span>.</p>
<p><br>
<br></p>
<p><strong>Exercise 3 (autocovariance function of the ARMA(1,1))</strong></p>
<p>Show that the covariance function <span class="math inline">\(\gamma(k) = \text{cov}(y_t, y_{t-k})\)</span> of the ARMA(1,1) process</p>
<p><span class="math display">\[
y_t = c + \phi y_{t-1} + \theta \varepsilon_{t-1} + \varepsilon_t, \quad \varepsilon_t \sim WN(0, \sigma^2_\varepsilon)
\]</span></p>
<p>with <span class="math inline">\(|\phi &lt; 1|\)</span> can be written as</p>
<p><span class="math display">\[
\gamma(k) =
\begin{cases}
\sigma^2_\varepsilon \left(1 + \frac{(\phi+\theta)^2}{1-\phi^2}\right) &amp; \qquad \text{for} \quad k=0 \\[1em]
\sigma^2_\varepsilon \left(\phi+\theta + \frac{(\phi+\theta)^2\phi}{1-\phi^2}\right) &amp; \qquad \text{for} \quad k=1 \\[1em]
\phi^{k-1} \ \gamma(1) &amp;  \qquad \text{for} \quad k&gt;1
\end{cases}
\]</span></p>
<p><em>Hint</em>: you may use the fact that for a linear time series <span class="math inline">\(y_t = \mu + \sum_{j=0}^\infty \psi_j \varepsilon_{t-j}\)</span> the autocovariance function is given by</p>
<p><span class="math display">\[
\gamma(k) = \sigma^2_\varepsilon \sum_{j=k}^\infty \psi_j \psi_{j-k},
\]</span></p>
<p>provided that <span class="math inline">\(\sum_{j=0}^{\infty} \psi_j^2 &lt; \infty\)</span>.</p>
<!-- # Footnotes and citations  -->
<!-- ## Footnotes -->
<!-- Footnotes are put inside the square brackets after a caret `^[]`. Like this one ^[This is a footnote.].  -->
<!-- ## Citations -->
<!-- Reference items in your bibliography file(s) using `@key`. -->
<!-- For example, we are using the **bookdown** package [@R-bookdown] (check out the last code chunk in index.Rmd to see how this citation key was added) in this sample book, which was built on top of R Markdown and **knitr** [@xie2015] (this citation was added manually in an external file book.bib).  -->
<!-- Note that the `.bib` files need to be listed in the index.Rmd with the YAML `bibliography` key. -->
<!-- The RStudio Visual Markdown Editor can also make it easier to insert citations: <https://rstudio.github.io/visual-markdown-editing/#/citations> -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="session03.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="session05.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aciancetta/finmetrics/edit/BRANCH/04-session04.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
