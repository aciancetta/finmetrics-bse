<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Session 1 Introduction to time series | Financial Econometrics - Tutorials</title>
  <meta name="description" content="TA materials for the Financial Econometrics course held by Prof. Christian Brownlees at the Barcelona School of Economics." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Session 1 Introduction to time series | Financial Econometrics - Tutorials" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="TA materials for the Financial Econometrics course held by Prof. Christian Brownlees at the Barcelona School of Economics." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Session 1 Introduction to time series | Financial Econometrics - Tutorials" />
  
  <meta name="twitter:description" content="TA materials for the Financial Econometrics course held by Prof. Christian Brownlees at the Barcelona School of Economics." />
  

<meta name="author" content="Alessandro Ciancetta" />


<meta name="date" content="2024-01-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Financial Econometrics at BSE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="session01.html"><a href="session01.html"><i class="fa fa-check"></i><b>1</b> Introduction to time series</a>
<ul>
<li class="chapter" data-level="1.1" data-path="session01.html"><a href="session01.html#stochastic-processes-and-dependence"><i class="fa fa-check"></i><b>1.1</b> Stochastic processes and dependence</a>
<ul>
<li class="chapter" data-level="" data-path="session01.html"><a href="session01.html#stationarity"><i class="fa fa-check"></i>Stationarity</a></li>
<li class="chapter" data-level="" data-path="session01.html"><a href="session01.html#ergodicity"><i class="fa fa-check"></i>Ergodicity</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="session01.html"><a href="session01.html#asymptotic-results"><i class="fa fa-check"></i><b>1.2</b> Asymptotic results</a></li>
<li class="chapter" data-level="1.3" data-path="session01.html"><a href="session01.html#empirical-moments-and-summary-statistics"><i class="fa fa-check"></i><b>1.3</b> Empirical moments and summary statistics</a></li>
<li class="chapter" data-level="1.4" data-path="session01.html"><a href="session01.html#hypothesis-testing"><i class="fa fa-check"></i><b>1.4</b> Hypothesis testing</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/aciancetta" target="blank">Alessandro Ciancetta</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Financial Econometrics - Tutorials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="session01" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Session 1</span> Introduction to time series<a href="session01.html#session01" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="stochastic-processes-and-dependence" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Stochastic processes and dependence<a href="session01.html#stochastic-processes-and-dependence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Stochastic processes allow for dependence in consecutive random variables <span class="math inline">\(\{\dots, Y_{-2}, Y_{-1}, Y_{0}, Y_{1}, Y_{2} \dots\}\)</span>. However, in practice, when we observe an empirical time series we are considering <em>one, truncated</em> realization of the stochastic process <span class="math inline">\(\{y_1, y_2, \dots, y_T\}\)</span>. As it is easy to imagine, this can cause some issues in studying the properties of an empirical time series. First, because we can only study the <em>finite</em> dimensional distribution of the process. Second, because our task is to learn something about the process using a single realization.</p>
<p>To overcome this limitations we need assumptions. In particular, two common assumptions in time series analysis are, loosely speaking:</p>
<ul>
<li><p>stationarity: the observed values in the sequence come from the same distribution, so that it is possible to learn from the past observations and to generalize the results to the entire, infinite stochastic process</p></li>
<li><p>ergodicity: values observed far away in time can be considered as independent, so that the sufficiently long series can be considered as a representative sample of the underlying distribution</p></li>
</ul>
<p>Under these (or similar) assumptions, we can use the observations within a single observed time series to learn the parameters of our models.</p>
<div id="stationarity" class="section level3 unnumbered hasAnchor">
<h3>Stationarity<a href="session01.html#stationarity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="session01.html#cb1-1" tabindex="-1"></a><span class="do">## Example 1: non-stationary series</span></span>
<span id="cb1-2"><a href="session01.html#cb1-2" tabindex="-1"></a><span class="co"># simulation</span></span>
<span id="cb1-3"><a href="session01.html#cb1-3" tabindex="-1"></a>t_max <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb1-4"><a href="session01.html#cb1-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, t_max)</span>
<span id="cb1-5"><a href="session01.html#cb1-5" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>t_max) {</span>
<span id="cb1-6"><a href="session01.html#cb1-6" tabindex="-1"></a>  <span class="cf">if</span> (t<span class="sc">&lt;=</span><span class="dv">100</span>) {</span>
<span id="cb1-7"><a href="session01.html#cb1-7" tabindex="-1"></a>    y[t] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb1-8"><a href="session01.html#cb1-8" tabindex="-1"></a>  }</span>
<span id="cb1-9"><a href="session01.html#cb1-9" tabindex="-1"></a>  <span class="cf">if</span> (t<span class="sc">&gt;</span><span class="dv">100</span> <span class="sc">&amp;</span> t<span class="sc">&lt;=</span><span class="dv">250</span>) {</span>
<span id="cb1-10"><a href="session01.html#cb1-10" tabindex="-1"></a>    y[t] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb1-11"><a href="session01.html#cb1-11" tabindex="-1"></a>  }</span>
<span id="cb1-12"><a href="session01.html#cb1-12" tabindex="-1"></a>  <span class="cf">if</span> (t<span class="sc">&gt;</span><span class="dv">250</span> <span class="sc">&amp;</span> t<span class="sc">&lt;=</span><span class="dv">400</span>) {</span>
<span id="cb1-13"><a href="session01.html#cb1-13" tabindex="-1"></a>    y[t] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb1-14"><a href="session01.html#cb1-14" tabindex="-1"></a>  }</span>
<span id="cb1-15"><a href="session01.html#cb1-15" tabindex="-1"></a>  <span class="cf">if</span> (t<span class="sc">&gt;</span><span class="dv">400</span> <span class="sc">&amp;</span> t<span class="sc">&lt;=</span>t_max) {</span>
<span id="cb1-16"><a href="session01.html#cb1-16" tabindex="-1"></a>    y[t] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">sd =</span> <span class="fl">0.05</span>)</span>
<span id="cb1-17"><a href="session01.html#cb1-17" tabindex="-1"></a>  }</span>
<span id="cb1-18"><a href="session01.html#cb1-18" tabindex="-1"></a>}</span>
<span id="cb1-19"><a href="session01.html#cb1-19" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb1-20"><a href="session01.html#cb1-20" tabindex="-1"></a><span class="fu">plot.ts</span>(y, <span class="at">main =</span> <span class="st">&quot;Non-stationary series&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
<div id="ergodicity" class="section level3 unnumbered hasAnchor">
<h3>Ergodicity<a href="session01.html#ergodicity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This examples shows how the assumptions of stationarity and ergodicity allow to learn the parameters of the distribution of the stochastic process from an empirical time series.</p>
<p>Let <span class="math inline">\(\{z_t\}_{t = 1}^{T} \stackrel{iid}{\sim} \mathcal{N}(0, 1)\)</span></p>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;= U_0 + 0.25z_t, \quad U_0 \sim \mathcal{N}(0, 10) \\
x_t &amp;= z_t + z_{t-1}
\end{aligned}
\]</span>
We have:
<span class="math display">\[
\mathbb{E}[y_t] = \mathbb{E}[x_t] = 0
\]</span>
<span class="math display">\[
\begin{aligned}
\text{cov}(y_t, y_{t-1}) &amp;=
\begin{cases}
1+0.25^2 &amp; h = 0 \\
1 &amp; h \neq 0
\end{cases} \\[1em]
\text{cov}(x_t, x_{t-1}) &amp;=
\begin{cases}
2 &amp; h = 0 \\
1 &amp; h = 1 \\
0 &amp; h \geq 2
\end{cases}
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="session01.html#cb2-1" tabindex="-1"></a><span class="do">## Example 2: weak dependence</span></span>
<span id="cb2-2"><a href="session01.html#cb2-2" tabindex="-1"></a><span class="co"># initialize object to store result</span></span>
<span id="cb2-3"><a href="session01.html#cb2-3" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb2-4"><a href="session01.html#cb2-4" tabindex="-1"></a>y_list <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, nsim<span class="sc">*</span>t_max), <span class="at">nrow =</span> t_max, <span class="at">ncol =</span> nsim)</span>
<span id="cb2-5"><a href="session01.html#cb2-5" tabindex="-1"></a><span class="co"># simulation</span></span>
<span id="cb2-6"><a href="session01.html#cb2-6" tabindex="-1"></a><span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb2-7"><a href="session01.html#cb2-7" tabindex="-1"></a>  <span class="fu">set.seed</span>(sim<span class="sc">+</span><span class="dv">123</span>)</span>
<span id="cb2-8"><a href="session01.html#cb2-8" tabindex="-1"></a>  U0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb2-9"><a href="session01.html#cb2-9" tabindex="-1"></a>  z  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(t_max)</span>
<span id="cb2-10"><a href="session01.html#cb2-10" tabindex="-1"></a>  y_list[,sim] <span class="ot">&lt;-</span> U0 <span class="sc">+</span> z</span>
<span id="cb2-11"><a href="session01.html#cb2-11" tabindex="-1"></a>}</span>
<span id="cb2-12"><a href="session01.html#cb2-12" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb2-13"><a href="session01.html#cb2-13" tabindex="-1"></a><span class="fu">plot.ts</span>(y_list[,<span class="dv">1</span>], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(y_list), <span class="fu">max</span>(y_list)), <span class="at">main =</span> <span class="st">&quot;Realizations of non-ergodic series&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb2-14"><a href="session01.html#cb2-14" tabindex="-1"></a><span class="fu">lines</span>(y_list[,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb2-15"><a href="session01.html#cb2-15" tabindex="-1"></a><span class="fu">lines</span>(y_list[,<span class="dv">3</span>], <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb2-16"><a href="session01.html#cb2-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="session01.html#cb3-1" tabindex="-1"></a><span class="co"># initialize object to store result</span></span>
<span id="cb3-2"><a href="session01.html#cb3-2" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb3-3"><a href="session01.html#cb3-3" tabindex="-1"></a>x_list <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, nsim<span class="sc">*</span>t_max), <span class="at">nrow =</span> t_max, <span class="at">ncol =</span> nsim)</span>
<span id="cb3-4"><a href="session01.html#cb3-4" tabindex="-1"></a><span class="co"># simulation</span></span>
<span id="cb3-5"><a href="session01.html#cb3-5" tabindex="-1"></a><span class="cf">for</span> (sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb3-6"><a href="session01.html#cb3-6" tabindex="-1"></a>  <span class="fu">set.seed</span>(sim<span class="sc">+</span><span class="dv">123</span>)</span>
<span id="cb3-7"><a href="session01.html#cb3-7" tabindex="-1"></a>  z  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(t_max<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb3-8"><a href="session01.html#cb3-8" tabindex="-1"></a>  x_list[,sim] <span class="ot">&lt;-</span> z[<span class="dv">2</span><span class="sc">:</span>(t_max<span class="sc">+</span><span class="dv">1</span>)] <span class="sc">+</span> z[<span class="dv">1</span><span class="sc">:</span>t_max]</span>
<span id="cb3-9"><a href="session01.html#cb3-9" tabindex="-1"></a>}</span>
<span id="cb3-10"><a href="session01.html#cb3-10" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb3-11"><a href="session01.html#cb3-11" tabindex="-1"></a><span class="fu">plot.ts</span>(x_list[,<span class="dv">1</span>], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(x_list), <span class="fu">max</span>(x_list)), <span class="at">main =</span> <span class="st">&quot;Realizations of ergodic series&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb3-12"><a href="session01.html#cb3-12" tabindex="-1"></a><span class="fu">lines</span>(x_list[,<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span>
<span id="cb3-13"><a href="session01.html#cb3-13" tabindex="-1"></a><span class="fu">lines</span>(x_list[,<span class="dv">3</span>], <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb3-14"><a href="session01.html#cb3-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
</div>
<div id="asymptotic-results" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Asymptotic results<a href="session01.html#asymptotic-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The problem with the series <span class="math inline">\(\{y_t\}\)</span> in the previous example is that the autocovariance function does not decay. Loosely speaking, the series gets stuck in the trajectory given by the initial draw of <span class="math inline">\(U_0\)</span> and does not revert to the true mean of the stochastic process. The main consequence is that we cannot learn the mean of the process by taking the average of the observations in a given time series.</p>
<p>The fact that some conditions about the decay of the autocovariance are required to recover the mean of the process is true in general. For example, the Law of Large Numbers (LLN) guarantees that the sample mean converges in probability to the true mean under the assumption that the autocovariances are absolutely summable:</p>
<p><span class="math display">\[
\sum_{k=0}^\infty |\gamma_k| &lt; \infty
\]</span></p>
<p>Notice that in the case of <span class="math inline">\(\{y_t\}\)</span> above instead <span class="math inline">\(\sum_{k=0}^\infty |\gamma_k| = \infty\)</span>. On the contrary, <span class="math inline">\(\{x_t\}\)</span> satisfies both the conditions of the LLN and of the Central Limit Theorem (CLT). The condition for the latter is that <span class="math inline">\(\{\phi_k\}_{k=0}^\infty\)</span> is absolutely summable in <span class="math inline">\(x_t = \mu + \sum_{k=0}^\infty\phi_k z_{t-k} = z_t + z_{t-1}\)</span>, which is trivially verified. Therefore, since <span class="math inline">\(\mu_x = 0\)</span>,</p>
<p><span class="math display">\[
\sqrt{T} \ \bar{x}_T  \ \xrightarrow{d} \ \mathcal{N}(0, \sigma^2_{LR}),
\]</span></p>
<p>with <span class="math inline">\(\sigma^2_{LR} = \sum_{k=-\infty}^\infty \gamma_k = \text{Var}(x_t) + 2\sum_{k=1}^\infty \gamma_k\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="session01.html#cb4-1" tabindex="-1"></a><span class="do">## Example 3: central limit theorem</span></span>
<span id="cb4-2"><a href="session01.html#cb4-2" tabindex="-1"></a>x_empirical <span class="ot">&lt;-</span> x_list[,<span class="dv">9</span>]</span>
<span id="cb4-3"><a href="session01.html#cb4-3" tabindex="-1"></a>x_means <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x_list)</span>
<span id="cb4-4"><a href="session01.html#cb4-4" tabindex="-1"></a>x_theory_variance <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span>t_max </span>
<span id="cb4-5"><a href="session01.html#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="session01.html#cb4-6" tabindex="-1"></a><span class="fu">rbind</span>(<span class="at">empirical_variance =</span> <span class="fu">var</span>(x_empirical) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>(<span class="fu">cov</span>(x_empirical[<span class="dv">1</span><span class="sc">:</span>(t_max<span class="dv">-1</span>)], x_empirical[<span class="dv">2</span><span class="sc">:</span>t_max])),</span>
<span id="cb4-7"><a href="session01.html#cb4-7" tabindex="-1"></a>      <span class="at">simulated_variance =</span> <span class="fu">var</span>(x_means<span class="sc">*</span><span class="fu">sqrt</span>(t_max)),</span>
<span id="cb4-8"><a href="session01.html#cb4-8" tabindex="-1"></a>      <span class="at">theoretical_variance =</span> x_theory_variance<span class="sc">*</span>t_max)</span></code></pre></div>
<pre><code>##                          [,1]
## empirical_variance   4.174614
## simulated_variance   4.050667
## theoretical_variance 4.000000</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="session01.html#cb6-1" tabindex="-1"></a><span class="do">## Plot empirical distribution VS. theoretical distribution</span></span>
<span id="cb6-2"><a href="session01.html#cb6-2" tabindex="-1"></a><span class="fu">hist</span>(x_means, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, </span>
<span id="cb6-3"><a href="session01.html#cb6-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Distribution of the simulated means&quot;</span>, </span>
<span id="cb6-4"><a href="session01.html#cb6-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Simulated means&quot;</span>)</span>
<span id="cb6-5"><a href="session01.html#cb6-5" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x_means), <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>)</span>
<span id="cb6-6"><a href="session01.html#cb6-6" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(<span class="fu">rnorm</span>(<span class="fl">1e6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(x_theory_variance))), <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="empirical-moments-and-summary-statistics" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Empirical moments and summary statistics<a href="session01.html#empirical-moments-and-summary-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this example we use the <img src="U.S.%20GDP%20data" alt="https://fred.stlouisfed.org/series/GDP" />.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="session01.html#cb7-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;../us-gdp.csv&quot;</span>)[,<span class="dv">2</span>]</span>
<span id="cb7-2"><a href="session01.html#cb7-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ts</span>(x, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1947</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb7-3"><a href="session01.html#cb7-3" tabindex="-1"></a>t_max <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb7-4"><a href="session01.html#cb7-4" tabindex="-1"></a><span class="fu">plot.ts</span>(x, <span class="at">main =</span> <span class="st">&quot;U.S. GDP&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Billions of dollars&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" />
We consider the annualized quarterly growth rates:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="session01.html#cb8-1" tabindex="-1"></a><span class="co"># xgrowth &lt;- ( (x[2:t_max]/x[1:(t_max-1)])^4 - 1 )*100</span></span>
<span id="cb8-2"><a href="session01.html#cb8-2" tabindex="-1"></a>xgrowth <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">*</span><span class="fu">diff</span>(<span class="fu">log</span>(x))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb8-3"><a href="session01.html#cb8-3" tabindex="-1"></a>xgrowth <span class="ot">&lt;-</span> <span class="fu">ts</span>(xgrowth, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1947</span>, <span class="dv">2</span>), <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb8-4"><a href="session01.html#cb8-4" tabindex="-1"></a><span class="fu">plot.ts</span>(xgrowth, <span class="at">main =</span> <span class="st">&quot;Annualized GDP growth&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="session01.html#cb9-1" tabindex="-1"></a><span class="do">## Example 4: empirical moments and summary statistics of the GDP growth</span></span>
<span id="cb9-2"><a href="session01.html#cb9-2" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb9-3"><a href="session01.html#cb9-3" tabindex="-1"></a><span class="fu">rbind</span>(</span>
<span id="cb9-4"><a href="session01.html#cb9-4" tabindex="-1"></a>  <span class="at">mean     =</span> <span class="fu">mean</span>(xgrowth),</span>
<span id="cb9-5"><a href="session01.html#cb9-5" tabindex="-1"></a>  <span class="at">variance =</span> <span class="fu">var</span>(xgrowth),</span>
<span id="cb9-6"><a href="session01.html#cb9-6" tabindex="-1"></a>  <span class="at">skewness =</span> <span class="fu">skewness</span>(xgrowth),</span>
<span id="cb9-7"><a href="session01.html#cb9-7" tabindex="-1"></a>  <span class="at">kurtosis =</span> <span class="fu">kurtosis</span>(xgrowth),</span>
<span id="cb9-8"><a href="session01.html#cb9-8" tabindex="-1"></a>  <span class="at">min      =</span> <span class="fu">min</span>(xgrowth),</span>
<span id="cb9-9"><a href="session01.html#cb9-9" tabindex="-1"></a>  <span class="at">max      =</span> <span class="fu">max</span>(xgrowth),</span>
<span id="cb9-10"><a href="session01.html#cb9-10" tabindex="-1"></a>  <span class="at">above_5  =</span> <span class="fu">mean</span>(xgrowth <span class="sc">&gt;</span> <span class="dv">5</span>),</span>
<span id="cb9-11"><a href="session01.html#cb9-11" tabindex="-1"></a>  <span class="at">annualized_volatility =</span> <span class="fu">sqrt</span>(<span class="dv">4</span>)<span class="sc">*</span><span class="fu">sd</span>(xgrowth)</span>
<span id="cb9-12"><a href="session01.html#cb9-12" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##                              [,1]
## mean                    6.1858847
## variance               26.5117326
## skewness               -0.9793909
## kurtosis               17.9597257
## min                   -34.4929551
## max                    33.4065902
## above_5                 0.6078431
## annualized_volatility  10.2979090</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="session01.html#cb11-1" tabindex="-1"></a><span class="do">## Autocovariance function</span></span>
<span id="cb11-2"><a href="session01.html#cb11-2" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(x, k) {</span>
<span id="cb11-3"><a href="session01.html#cb11-3" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">abs</span>(k)</span>
<span id="cb11-4"><a href="session01.html#cb11-4" tabindex="-1"></a>  t_max <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb11-5"><a href="session01.html#cb11-5" tabindex="-1"></a>  <span class="co"># (t_max-k)/t_max * cov(x[1:(length(x)-k)], x[(k+1):length(x)]) # for compatibility with acf()</span></span>
<span id="cb11-6"><a href="session01.html#cb11-6" tabindex="-1"></a>  <span class="fu">cov</span>(x[<span class="dv">1</span><span class="sc">:</span>(t_max<span class="sc">-</span>k)], x[(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>t_max])</span>
<span id="cb11-7"><a href="session01.html#cb11-7" tabindex="-1"></a>}</span>
<span id="cb11-8"><a href="session01.html#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="session01.html#cb11-9" tabindex="-1"></a><span class="do">## Autocorrelation</span></span>
<span id="cb11-10"><a href="session01.html#cb11-10" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="cf">function</span>(x, k) {<span class="fu">gamma</span>(x, k) <span class="sc">/</span> <span class="fu">gamma</span>(x, <span class="dv">0</span>)}</span>
<span id="cb11-11"><a href="session01.html#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="session01.html#cb11-12" tabindex="-1"></a><span class="do">## autocorrelation at different lags</span></span>
<span id="cb11-13"><a href="session01.html#cb11-13" tabindex="-1"></a><span class="fu">sapply</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">12</span>, rho, <span class="at">x =</span> xgrowth)</span></code></pre></div>
<pre><code>##  [1]  1.000000000  0.262228567  0.254514380  0.097922439  0.030475252
##  [6] -0.016390183 -0.003186283  0.054980002  0.062358818  0.146571003
## [11]  0.169620140  0.143289793  0.096325249</code></pre>
<p>Under the null hypothesis <span class="math inline">\(H_0: \rho = 0\)</span>, the sample autocorrelation is distributed as
<span class="math display">\[
\sqrt{T} \ \hat{\rho} \xrightarrow{d} \mathcal{N}(0, 1)
\]</span></p>
<p>This means that the asymptotic variance of the estimator under the null is <span class="math inline">\(1/T\)</span>. The plot reports the 95% confidence interval obtained as <span class="math inline">\(\left(0 \pm \frac{z_{0.975}}{\sqrt{T}}\right)\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="session01.html#cb13-1" tabindex="-1"></a><span class="do">## using built-in function for the autocorrelogram</span></span>
<span id="cb13-2"><a href="session01.html#cb13-2" tabindex="-1"></a><span class="fu">acf</span>(xgrowth, <span class="at">lag.max =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="session01.html#cb14-1" tabindex="-1"></a><span class="do">## partial autocorrelation function</span></span>
<span id="cb14-2"><a href="session01.html#cb14-2" tabindex="-1"></a><span class="fu">pacf</span>(xgrowth, <span class="at">lag.max =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="hypothesis-testing" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Hypothesis testing<a href="session01.html#hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this section we use three testing procedures on the GDP growth data: the Augmented Dickey-Fuller test for stationarity, the Jarque-Bera test for normality and the t-test for the mean of a process.</p>
<!-- :::: {.example} -->
<!-- **Example** (Exponential trend cannot be reduced to stationarity) -->
<!-- Include the actual content here. -->
<!-- :::: -->
<!-- Integrated series: transformation for stationariy -->
<!-- counterexample: exponential is $I(\infty)$ -->
<!-- first difference, percentage changes, log-changes -->
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="session01.html#cb15-1" tabindex="-1"></a><span class="do">## Example 5: tests on GDP growth rates </span></span>
<span id="cb15-2"><a href="session01.html#cb15-2" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb15-3"><a href="session01.html#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="session01.html#cb15-4" tabindex="-1"></a><span class="do">## stationarity: augmented Dickey-Fuller</span></span>
<span id="cb15-5"><a href="session01.html#cb15-5" tabindex="-1"></a><span class="fu">adf.test</span>(x)</span></code></pre></div>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  x
## Dickey-Fuller = 2.4611, Lag order = 6, p-value = 0.99
## alternative hypothesis: stationary</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="session01.html#cb17-1" tabindex="-1"></a><span class="fu">adf.test</span>(xgrowth)</span></code></pre></div>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  xgrowth
## Dickey-Fuller = -5.9064, Lag order = 6, p-value = 0.01
## alternative hypothesis: stationary</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="session01.html#cb19-1" tabindex="-1"></a><span class="do">## normality: Jarque-Bera</span></span>
<span id="cb19-2"><a href="session01.html#cb19-2" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(xgrowth)</span></code></pre></div>
<pre><code>## 
##  Jarque Bera Test
## 
## data:  xgrowth
## X-squared = 2902.3, df = 2, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="session01.html#cb21-1" tabindex="-1"></a><span class="do">## mean zero: z-test</span></span>
<span id="cb21-2"><a href="session01.html#cb21-2" tabindex="-1"></a>sigmaLR <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sapply</span>(<span class="sc">-</span><span class="dv">100</span><span class="sc">:</span><span class="dv">100</span>, gamma, <span class="at">x =</span> xgrowth))</span>
<span id="cb21-3"><a href="session01.html#cb21-3" tabindex="-1"></a>t_stat  <span class="ot">&lt;-</span> <span class="fu">mean</span>(xgrowth)<span class="sc">/</span>(<span class="fu">sqrt</span>(sigmaLR<span class="sc">/</span>t_max))</span>
<span id="cb21-4"><a href="session01.html#cb21-4" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(t_stat)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb21-5"><a href="session01.html#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="session01.html#cb21-6" tabindex="-1"></a><span class="co"># t.test(xgrowth, mu = 0)</span></span>
<span id="cb21-7"><a href="session01.html#cb21-7" tabindex="-1"></a><span class="co"># mean(xgrowth)/(sqrt((t_max/(t_max-1))*var(xgrowth)/t_max)) # for compatibility with t-test()</span></span>
<span id="cb21-8"><a href="session01.html#cb21-8" tabindex="-1"></a>t_stat_unadjasted <span class="ot">&lt;-</span> <span class="fu">mean</span>(xgrowth)<span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="fu">var</span>(xgrowth)<span class="sc">/</span>t_max))</span>
<span id="cb21-9"><a href="session01.html#cb21-9" tabindex="-1"></a>p_value_unadjasted <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(t_stat_unadjasted)))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb21-10"><a href="session01.html#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="session01.html#cb21-11" tabindex="-1"></a><span class="fu">rbind</span>(<span class="at">p_value_unadjasted =</span> p_value_unadjasted,</span>
<span id="cb21-12"><a href="session01.html#cb21-12" tabindex="-1"></a>      <span class="at">p_value =</span> p_value)</span></code></pre></div>
<pre><code>##                            [,1]
## p_value_unadjasted 0.000000e+00
## p_value            4.884981e-15</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="session01.html#cb23-1" tabindex="-1"></a><span class="co"># We can study when adjustment really matters using the results of the previous</span></span>
<span id="cb23-2"><a href="session01.html#cb23-2" tabindex="-1"></a><span class="co"># Monte Carlo simulation</span></span>
<span id="cb23-3"><a href="session01.html#cb23-3" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x_list)</span>
<span id="cb23-4"><a href="session01.html#cb23-4" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">apply</span>(x_list, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">gamma</span>(x, <span class="at">k =</span> <span class="dv">0</span>)<span class="sc">/</span><span class="fu">length</span>(x)))</span>
<span id="cb23-5"><a href="session01.html#cb23-5" tabindex="-1"></a>sigmaLR <span class="ot">&lt;-</span> <span class="fu">apply</span>(x_list, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">sum</span>(<span class="fu">sapply</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span>, gamma, <span class="at">x =</span> x))<span class="sc">/</span><span class="fu">length</span>(x)))</span>
<span id="cb23-6"><a href="session01.html#cb23-6" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> ybar<span class="sc">/</span>sigma</span>
<span id="cb23-7"><a href="session01.html#cb23-7" tabindex="-1"></a>t_stat_adjusted <span class="ot">&lt;-</span> ybar<span class="sc">/</span>sigmaLR</span>
<span id="cb23-8"><a href="session01.html#cb23-8" tabindex="-1"></a>type1error     <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(t_stat) <span class="sc">&gt;</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span>
<span id="cb23-9"><a href="session01.html#cb23-9" tabindex="-1"></a>type1error_adj <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(t_stat_adjusted) <span class="sc">&gt;</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>))</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="session01.html#cb24-1" tabindex="-1"></a><span class="co"># distributions</span></span>
<span id="cb24-2"><a href="session01.html#cb24-2" tabindex="-1"></a><span class="fu">hist</span>(t_stat, <span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">&quot;tomato&quot;</span>, </span>
<span id="cb24-3"><a href="session01.html#cb24-3" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.45</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">6</span>), <span class="at">xlab =</span> <span class="st">&quot;t-stat&quot;</span>, </span>
<span id="cb24-4"><a href="session01.html#cb24-4" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Distribution of the t-statistic in Monte Carlo simulation&quot;</span>)</span>
<span id="cb24-5"><a href="session01.html#cb24-5" tabindex="-1"></a><span class="fu">hist</span>(t_stat_adjusted, <span class="at">breaks =</span> <span class="dv">100</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>)</span>
<span id="cb24-6"><a href="session01.html#cb24-6" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(<span class="fu">rnorm</span>(<span class="fl">1e6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)), <span class="at">lwd =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb24-7"><a href="session01.html#cb24-7" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Unadjusted&quot;</span>, <span class="st">&quot;Adjusted&quot;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>), <span class="at">lwd=</span><span class="dv">6</span>)</span>
<span id="cb24-8"><a href="session01.html#cb24-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb24-9"><a href="session01.html#cb24-9" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fl">6.5</span>, <span class="fl">6.5</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.25</span>), </span>
<span id="cb24-10"><a href="session01.html#cb24-10" tabindex="-1"></a>     <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;Type 1 error: &quot;</span>, <span class="fu">round</span>(type1error<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>),</span>
<span id="cb24-11"><a href="session01.html#cb24-11" tabindex="-1"></a>              <span class="fu">paste0</span>(<span class="st">&quot;Type 1 error adjusted: &quot;</span>, <span class="fu">round</span>(type1error_adj<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), </span>
<span id="cb24-12"><a href="session01.html#cb24-12" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;tomato&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>), <span class="at">pos =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<!-- # Hello bookdown  -->
<!-- All chapters start with a first-level heading followed by your chapter title, like the line above. There should be only one first-level heading (`#`) per .Rmd file. -->
<!-- ## A section -->
<!-- All chapter sections start with a second-level (`##`) or higher heading followed by your section title, like the sections above and below here. You can have as many as you want within a chapter. -->
<!-- ### An unnumbered section {-} -->
<!-- Chapters and sections are numbered by default. To un-number a heading, add a `{.unnumbered}` or the shorter `{-}` at the end of the heading, like in this section. -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/01-session01.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
